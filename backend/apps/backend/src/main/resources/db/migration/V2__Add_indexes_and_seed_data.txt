-- Create indexes for performance
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_role ON users(role);
CREATE INDEX idx_tenants_tenant_id ON tenants(tenant_id);
CREATE INDEX idx_user_sessions_token ON user_sessions(session_token);

CREATE INDEX idx_email_verification_tokens_token ON email_verification_tokens(token);
CREATE INDEX idx_email_verification_tokens_user_id ON email_verification_tokens(user_id);
CREATE INDEX idx_email_verification_tokens_expires_at ON email_verification_tokens(expires_at);

CREATE INDEX idx_password_reset_tokens_token ON password_reset_tokens(token);
CREATE INDEX idx_password_reset_tokens_user_id ON password_reset_tokens(user_id);
CREATE INDEX idx_password_reset_tokens_expires_at ON password_reset_tokens(expires_at);

-- Insert default data
INSERT INTO tenants (tenant_id, name, plan)
VALUES ('default_tenant', 'Default Organization', 'FREE');

-- Insert super admin (password: admin123)
INSERT INTO users (full_name, email, password, role, active, email_verified)
VALUES ('Super Admin', 'admin@dascribs.com', '$2a$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'SUPER_ADMIN', true, true);

-- Link admin to tenant
INSERT INTO user_tenants (user_id, tenant_id, is_primary)
SELECT u.id, t.id, true
FROM users u, tenants t
WHERE u.email = 'admin@dascribs.com' AND t.tenant_id = 'default_tenant';